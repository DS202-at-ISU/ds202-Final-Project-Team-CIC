---
title: "DS 202 Final Project"
output:
  github_document:
    number_section: FALSE
---

<!-- README.md is generated from README.Rmd. Please edit the README.Rmd file -->

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = FALSE, warning = TRUE)


knit_hooks$set( fig.cap = function(before, options, envir) {
  if ( before ) {
    chr <- sprintf("<p><small><strong><a name='fig:%s' value = %d>Figure %d</a></strong>: %s</small></p>", options$label, options$fig.num, options$fig.num, options$fig.cap)
    chr <- sprintf("<p><small><strong><a name='fig:%s'>%s</a></strong>: %s</small></p>", options$label, options$label,  options$fig.cap)
    
    return(chr)
  }
})


chunkref <- local({
  function(chunklabel) {
    sprintf('[%s](#%s)', chunklabel, paste0("fig:",chunklabel) )
  }  
})

library(ggplot2)
library(dplyr)
library(tidyverse)
```


This repository serves as a starter repo for your final project, and this Rmd is supposed to serve as a starter file for your project report.

## Part I: Repo Structure {.unnumbered}

The structure sketched out below is an idea of what your repository might look like. You can use it as a starting base and change according to your needs. But think about the changes that you make!

    -- code
    |   |   -- any R scripts you need but don't want to include directly in the write-up
    -- data
    |   |   -- csv files (cleaned data)
    -- data-raw
    |   |   -- raw data files 
    |   |   -- data description files, origin
    |   |   -- Codebook
    -- final-project.Rmd
    -- images  # only images that are not created by the Rmd
    -- LICENSE
    -- README.md
    -- README.Rmd
    -- README_files # folder with files created during the knitting process

## Part II: Project report {.unnumbered}



# Title of your project {.unnumbered}

Authors: Cole Flickinger, Isaac Irving, Cameron Kraklio

## Abstract (TL;DR) {.unnumbered}

An abstract is a quick summary of your work. Ideally it should motivate someone to read the rest of the paper. Include one sentence each on

-   what is the project about?
-   what is the motivation for doing it?
-   what data is your work based on? and where does it come from? = what are your main findings? (one sentence each)

# Intro/Background/Motivation

What is the topic of your project, why is it relevant?
Our project looks at a number of health categories and how they relate to sleep and lifestyle choices. It is relevant since sleep and health statistics are categories that everyone is going to be concernerd about.

At the end of the Intro, write a sentence describing what each of the (result) sections is about, e.g. in section [Results 1] we show the relationship between XXX and YYY,  section [Results 2] also considers the effect of variable ZZZ. ...
Finally we conclude with a quick summary of our findings and potential follow-up work in section [Conclusions].

Somewhere at the beginning of your project, include a code chunk that includes all of the R packages you are using throughout. In this document, the setup code chunk is called `setup` (see line 8) Also make sure to set defaults for the code chunks - like should they be visible? (probably not: echo=FALSE). Do you want to automatically include warnings? (probably yes, for creating the Rmd, to make sure that all warnings are accounted for)

# Quick Data Summary

What are the variables that you will be using in the main part of the report? What are their ranges? You could include a table with variable names, a short explanation, and (very broad) summary statistics.

The variables we will be focusing on are:
Occupation: what the person does for work
Stress level - ranged from 3 to 8
Sleep duration - ranges from 5.8 to 8.5 hours
Quality of sleep - ranges from 4 to 9
BMI category - what category the person fits into on the BMI scale

# Results

Each line of exploration is supposed to be featured in one of the Results sections. Make sure to change to more interesting section headers!

## Results 1

```{r scatterplot, echo=FALSE, fig.cap="This is the figure caption. Make sure to use the description we practised in the homework: first sentence describes structure of the plot, second sentence describes main finding, third sentence describes outliers/follow-up.", message = FALSE}
df <- read_csv("Sleep_health_and_lifestyle_dataset.csv")
str(df)
```

```{r}
ggplot(df, aes(x = `BMI Category`, fill = `Sleep Disorder`)) +
  geom_bar(position = "fill") +
  labs(title = "Prevalence of Sleep Disorders by BMI Category",
       y = "Proportion",
       x = "BMI Category") +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal()

ggplot(df, aes(x = `Stress Level`, y = `Quality of Sleep`)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Sleep Quality vs. Stress Level",
       subtitle = "Colored by Sleep Disorder Presence") +
  theme_minimal()

ggplot(df, aes(x = Age, fill = `Sleep Disorder`)) +
  geom_histogram(binwidth = 2, position = "identity", alpha = 0.7) +
  labs(title = "Age Distribution by Sleep Disorder Status",
       x = "Age",
       y = "Count") +
  theme_minimal()

ggplot(df, aes(x = `Sleep Duration`, y = `Quality of Sleep`, color = `Sleep Disorder`)) +
  geom_jitter(width = 0.1, height = 0.1) +
  labs(title = "Sleep Duration vs. Quality Colored by Disorder",
       x = "Sleep Duration (hours)",
       y = "Sleep Quality (1-10)") +
  theme_minimal()

library(ggplot2)

ggplot(df, aes(x = Age, y = `Stress Level`)) +
  geom_point(size = 3, alpha = 0.5, color = "steelblue") +  # All points same color
  labs(
    title = "Stress Levels Increase with Age",
    x = "Age",
    y = "Stress Level (1-10)",
  ) +
  scale_x_continuous(breaks = seq(20, 70, by = 5)) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
    panel.grid.minor = element_blank()
  )
```

Additionally, you can also refer to different sections in your writeup by using anchors (links) to section headers. Here, we are referring to subsection [Results 3]. The code for that is `[Results 3]`.

## Results 2

Cole Flickinger: Attempt to look at health and sleep based on occupation alone.

```{r}
head(df)
summary(df)
summary(df$Occupation)
unique(df$Occupation)
df %>% ggplot(aes(x = `Stress Level`, y = `Quality of Sleep`)) + geom_line() + facet_wrap(~df$Occupation)
```
```{r}
print(df$Occupation)
#Analyze stress levels by occupation
job_stress <- df %>%
  group_by(Occupation) %>%
  summarize(
    mean_stress = mean(`Stress Level`),
    median_stress = median(`Stress Level`),
    sd_stress = sd(`Stress Level`),
    count = n()
  ) %>%
  arrange(desc(mean_stress))
print(job_stress)

# Create a dataset that gives count of people by job and stress level
job_stress_dist <- df %>%
  group_by(Occupation, `Stress Level`) %>%
  summarize(count = n(), .groups = 'drop') %>%
  # Calculate percentage within each job
  group_by(Occupation) %>%
  mutate(
    percentage = count / sum(count) * 100,
    # Ensure stress levels are treated as numeric for the line plot
    `Stress Level` = as.numeric(`Stress Level`)
  )

# Create a faceted line plot showing stress level distribution by job
ggplot(job_stress_dist, aes(x = `Stress Level`, y = percentage, group = Occupation)) +
  geom_line(color = "steelblue", linewidth = 1) +
  geom_point(color = "steelblue", size = 2) +
  facet_wrap(~ Occupation) +
  labs(
    title = "Distribution of Stress Levels by Occupation",
    x = "Stress Level (1-10 scale)",
    y = "Percentage of Individuals (%)",
    caption = "Source: Sleep Health and Lifestyle Dataset"
  ) +
  theme_minimal() +
  theme(
    strip.background = element_rect(fill = "lightblue", color = "black"),
    strip.text = element_text(face = "bold"),
    panel.grid.minor = element_blank()
  ) +
  scale_x_continuous(breaks = seq(1, 10, 1))  # Fixed: Use seq() for breaks from 1 to 10

# Alternative visualization: Boxplot of stress levels by occupation
ggplot(df, aes(x = reorder(Occupation, `Stress Level`, FUN = median), y = `Stress Level`, fill = Occupation)) +
  geom_boxplot(alpha = 0.7) +
  coord_flip() +
  labs(
    title = "Stress Levels by Occupation",
    x = "",
    y = "Stress Level (1-10 scale)",
    caption = "Source: Sleep Health and Lifestyle Dataset"
  ) +
  theme_minimal() +
  theme(legend.position = "none") +
  scale_fill_brewer(palette = "Set3")

# Investigate relationship between stress level and sleep duration by occupation
ggplot(df, aes(x = `Stress Level`, y = `Sleep Duration`, color = Occupation)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~ Occupation) +
  labs(
    title = "Relationship Between Stress Level and Sleep Duration by Occupation",
    x = "Stress Level (1-10 scale)",
    y = "Sleep Duration (hours)",
    caption = "Source: Sleep Health and Lifestyle Dataset"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    strip.background = element_rect(fill = "lightblue", color = "black"),
    strip.text = element_text(face = "bold")
  )
```
Notable: there is only 1 manager, 26 salespersons, and 4 sales representatives.

## Results 3

...

# Conclusions

Give a quick summary of your work. Here is the place to be a bit critical and discuss potential limitations. Add a sentence on what else you would have liked to include in your data exploration if you had more time or more members in your team. 

## Data source {.unnumbered}

Where does the data come from, who owns the data? Where are all the scripts that you need to clean the data?

## References {.unnumbered}

List all resources you used.
